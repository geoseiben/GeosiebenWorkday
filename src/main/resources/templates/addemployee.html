<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Onboarding Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .step-active { color: #2563eb; border-color: #2563eb; }
        .step-complete { color: #059669; border-color: #059669; background-color: #ecfdf5; }
        input:invalid:not(:placeholder-shown) { border-color: #ef4444; }
        input:valid:not(:placeholder-shown) { border-color: #10b981; }
        .form-section { display: none; }
        .form-section.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Spinner for loading state */
        .spinner {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 2px solid #fff;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .view-content {
            display: none;
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .view-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dropdown Logic */
        .dropdown-menu {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.2s ease;
        }
        .group:hover .dropdown-menu {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .nav-link.active {
            color: var(--primary);
            position: relative;
        }
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary);
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
<head th:replace="includes/header :: header"></head>
<div class="max-w-8xl mx-auto py-8 px-4">
    <!-- Header -->
    <div class="text-center mb-10">
        <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">Employee Onboarding</h1>
    </div>

    <!-- Stepper -->
    <div class="mb-12 overflow-x-auto">
        <div class="flex items-center justify-between min-w-[800px] px-4">
            <div class="step-item flex flex-col items-center gap-2" data-step="1">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold step-active bg-white">1</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Basic</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="2">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">2</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Employment</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="3">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">3</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Role</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="4">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">4</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Education</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="5">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">5</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Legal</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="6">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">6</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Bank</span>
            </div>
            <div class="h-px bg-gray-200 flex-1 mx-4"></div>
            <div class="step-item flex flex-col items-center gap-2" data-step="7">
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-bold text-gray-400 border-gray-200 bg-white">7</div>
                <span class="text-xs font-semibold uppercase tracking-wider">Emergency</span>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-3xl shadow-xl shadow-slate-200/60 border border-slate-100 overflow-hidden">
        <form id="employeeForm" enctype="multipart/form-data">
            <!-- Section 1: Basic Information -->
            <div class="form-section active p-8 md:p-12" data-step="1">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-blue-50 text-blue-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                        </span>
                    Personal Identity
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Emp ID</label>
                        <input type="text" name="employeeId"  plceholder="EMP-001" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">First Name *</label>
                        <input type="text" name="firstName"  required placeholder="Enter first name" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Last Name</label>
                        <input type="text" name="lastName"  placeholder="Enter last name" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Father's Name</label>
                        <input type="text" name="fatherName"  class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Residential Address</label>
                        <input type="text" name="address"  placeholder="Street, Building, Flat No." class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Gender</label>
                        <select name="gender" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all appearance-none bg-[url('data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%20fill%3D%22none%22%20stroke%3D%22currentColor%20currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E')] bg-[length:20px] bg-[right_1rem_center] bg-no-repeat">
                            <option >Select</option>
                            <option >Male</option><option>Female</option><option>Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Date of Birth</label>
                        <input type="date" name="dob"  class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Email Address</label>
                        <input type="email" name="personalEmail" placeholder="name@personal.com" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Phone Number</label>
                        <input type="tel" name="phone"  pattern="[0-9]{10}" placeholder="10 Digit Number" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Upload Photo</label>
                        <div class="relative group">
                            <input type="file" name="photo" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10">
                            <div class="w-full px-4 py-3 rounded-xl border-2 border-dashed border-slate-200 group-hover:border-blue-400 text-center text-slate-500 transition-all">
                                Click to upload
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Blood Group</label>
                        <select name="bloodGroup" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none appearance-none bg-no-repeat bg-[right_1rem_center] bg-[length:20px] bg-white">
                            <option >Select</option>
                            <option >O+</option><option>A+</option><option>B+</option><option>AB+</option><option>O-</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Marital Status</label>
                        <select name="maritalStatus" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none appearance-none bg-white">
                            <option value="">Select</option>
                            <option >Single</option><option>Married</option><option>Other</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section 2: Employment Details -->
            <div class="form-section p-8 md:p-12" data-step="2">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-emerald-50 text-emerald-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
                        </span>
                    Joining Details
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Date of Joining</label>
                        <input type="date" name="doj" id="doj"  class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Probation (Months)</label>
                        <input type="number" name="probationMonths" id="probation"  placeholder="e.g. 6" class="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-emerald-500 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Confirmation Date</label>
                        <input type="date" name="confirmationdate" id="confirmationDate"  readonly class="w-full px-4 py-3 rounded-xl border border-slate-100 bg-slate-50 text-slate-500 cursor-not-allowed">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Emp Status</label>
                        <select name="employmentStatus" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none">
                            <option >Confirmed</option><option>Probation</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Reporting Manager</label>
                        <input type="text" name="managerName"  placeholder="Manager Name" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Work Email</label>
                        <input type="email" name="workEmail"  placeholder="official@company.com" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none transition-all">
                    </div>
                </div>
            </div>

            <!-- Section 3: Designation -->
            <div class="form-section p-8 md:p-12" data-step="3">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-indigo-50 text-indigo-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 20V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v16"/><rect width="20" height="14" x="2" y="6" rx="2"/></svg>
                        </span>
                    Professional Role
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Designation</label>
                        <select name="designation" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none">
                            <option selected>Lead Developer</option><option>Senior Associate</option><option>Product Owner</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Department</label>
                        <select name="department" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none">
                            <option selected>Technology</option><option>Operations</option><option>Finance</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section 4: Education -->
            <div class="form-section p-8 md:p-12" data-step="4">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-amber-50 text-amber-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
                        </span>
                    Academics
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Degree</label><input type="text" name="degree"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">FOS</label><input type="text" name="fieldOfStudy"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Passing Year</label><input type="number" name="yearOfPassing"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">GPA</label><input type="text" name="gpa"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div class="md:col-span-2"><label class="block text-sm font-semibold text-slate-700 mb-2">College</label><input type="text" name="college"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                </div>
            </div>

            <!-- Section 5: Legal -->
            <div class="form-section p-8 md:p-12" data-step="5">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-red-50 text-red-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                        </span>
                    Legal & Compliance
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Aadhar</label><input type="text" name="aadhar"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">PAN</label><input type="text" name="pan"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none uppercase"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">UAN</label><input type="text" name="uan"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">PF No</label><input type="text" name="pfNo"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">PF Start</label><input type="date" name="pfStart"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">ESI No</label><input type="text" name="esiNo"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Onsurity</label><select name="onurity" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"><option selected>Opt-in</option><option>Opt-out</option></select></div>
                </div>
            </div>

            <!-- Section 6: Bank -->
            <div class="form-section p-8 md:p-12" data-step="6">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-cyan-50 text-cyan-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="12" x="2" y="6" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>
                        </span>
                    Bank Accounts
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Mode</label><select name="paymentMode" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"><option selected>Bank Transfer</option><option>Check</option></select></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Bank</label><select name="bankName" class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"><option selected>HDFC</option><option>ICICI</option></select></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Branch</label><input type="text" name="bankBranch"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">IFSC</label><input type="text" name="bankIfsc"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none uppercase"></div>
                    <div class="md:col-span-2"><label class="block text-sm font-semibold text-slate-700 mb-2">Account No</label><input type="password" name="accountNo"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                </div>
            </div>

            <!-- Section 7: Emergency -->
            <div class="form-section p-8 md:p-12" data-step="7">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                        <span class="p-2 bg-rose-50 text-rose-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4"/><path d="m15.5 7.5-3-3a1 1 0 0 0-1.4 0L9 6.6"/><path d="m15.5 7.5 3 3a1 1 0 0 1 0 1.4L16.2 14"/><path d="m15.5 7.5-3-3a1 1 0 0 1 0-1.4l2.1-2.1"/><path d="m7.5 15.5 3 3a1 1 0 0 0 1.4 0L14 16.4"/><path d="m7.5 15.5-2.3-2.3a1 1 0 0 1 0-1.4L7.3 9.7"/><path d="m7.5 15.5-3-3a1 1 0 0 0-1.4 0L1 14.6"/><path d="m7.5 15.5 3 3a1 1 0 0 1 0 1.4l-2.1 2.1"/></svg>
                        </span>
                    Emergency Liaison
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Full Name</label><input type="text" name="emergencyName"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Phone</label><input type="tel" name="emergencyPhone"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                    <div><label class="block text-sm font-semibold text-slate-700 mb-2">Relationship</label><input type="text" name="emergencyRelation"  class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none"></div>
                </div>
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <!-- Control Bar -->
            <div class="bg-slate-50 border-t border-slate-100 p-6 flex justify-between items-center">
                <button type="button" id="prevBtn" class="invisible px-6 py-2.5 font-semibold text-slate-600 hover:bg-slate-200 rounded-xl transition-all flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    Back
                </button>
                <div class="flex gap-4">
                    <button type="button" id="nextBtn" class="px-8 py-2.5 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 flex items-center gap-2 transition-all">
                        Next Step
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                    </button>
                    <button type="submit" id="submitBtn" class="hidden px-8 py-2.5 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all flex items-center gap-2">
                        <span>Finish & Submit</span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Success Feedback Overlay -->
<div id="successModal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-3xl p-10 max-w-sm w-full text-center shadow-2xl">
        <div class="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
            </svg>
        </div>
        <h3 class="text-2xl font-extrabold text-gray-900">All Set!</h3>
        <p class="text-slate-500 mt-3 text-lg">Your onboarding data has been securely transmitted.</p>
        <button onclick="location.reload()" class="mt-8 w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors">
            Back to Home
        </button>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    let currentStep = 1;
    const totalSteps = 7;

    const sections = document.querySelectorAll('.form-section');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const submitBtn = document.getElementById('submitBtn');
    const stepItems = document.querySelectorAll('.step-item div');
    const employeeForm = document.getElementById('employeeForm');

    function updateStepUI() {
        sections.forEach(s => s.classList.remove('active'));
        document.querySelector(`.form-section[data-step="${currentStep}"]`).classList.add('active');

        // Update Stepper
        stepItems.forEach((item, idx) => {
            const stepNum = idx + 1;
            item.classList.remove('step-active', 'step-complete', 'text-gray-400', 'border-gray-200');

            if(stepNum < currentStep) {
                item.classList.add('step-complete');
                item.innerHTML = 'âœ“';
            } else if (stepNum === currentStep) {
                item.classList.add('step-active');
                item.innerHTML = stepNum;
            } else {
                item.classList.add('text-gray-400', 'border-gray-200');
                item.innerHTML = stepNum;
            }
        });

        // Button Visibility
        prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';
        if(currentStep === totalSteps) {
            nextBtn.classList.add('hidden');
            submitBtn.classList.remove('hidden');
        } else {
            nextBtn.classList.remove('hidden');
            submitBtn.classList.add('hidden');
        }
    }

    nextBtn.addEventListener('click', () => {
        // Section-wise validation
        const currentSection = document.querySelector(`.form-section[data-step="${currentStep}"]`);
        const requiredFields = currentSection.querySelectorAll('[required]');
        let valid = true;

        requiredFields.forEach(field => {
            if(!field.value) {
                field.classList.add('border-red-500');
                valid = false;
            } else {
                field.classList.remove('border-red-500');
            }
        });

        if(valid && currentStep < totalSteps) {
            currentStep++;
            updateStepUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    });

    prevBtn.addEventListener('click', () => {
        if(currentStep > 1) {
            currentStep--;
            updateStepUI();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    });

    // Confirmation Date Logic
    const doj = document.getElementById('doj');
    const probation = document.getElementById('probation');
    const confirmDate = document.getElementById('confirmation_date');

    function calcDate() {
        if(doj.value && probation.value) {
            const d = new Date(doj.value);
            d.setMonth(d.getMonth() + parseInt(probation.value));
            confirmDate.value = d.toISOString().split('T')[0];
        }
    }
    doj.addEventListener('change', calcDate);
    probation.addEventListener('input', calcDate);
    employeeForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const originalBtnText = submitBtn.innerHTML;
        submitBtn.disabled = true;
        submitBtn.innerHTML = `<span class="spinner mr-2"></span> Processing...`;

        try {
            const formData = new FormData(employeeForm);

            // Optional: normalize empty strings to null before appending
            for (let [key, value] of formData.entries()) {
                if (typeof value === 'string' && value.trim() === "") {
                    formData.set(key, null);
                }
            }

            console.log('--- Submission FormData ---');
            for (let [key, value] of formData.entries()) {
                console.log(key, value);
            }

            $.ajax({
                url: '/admin/addemployeee',
                type: 'POST',
                data: formData,
                processData: false,   // ðŸš¨ prevent jQuery from serializing
                contentType: false,   // ðŸš¨ let browser set multipart/form-data
                success: function (resp) {
                    console.log(resp);
                },
                error: function (err) {
                    console.log(err);
                }
            });

        } catch (error) {
            console.error('Submit Error:', error);
            alert('Submission failed: ' + error.message);

            submitBtn.disabled = false;
            submitBtn.innerHTML = originalBtnText;
        }
    });


</script>
</body>
</html>